<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8 />
    <title>Démo Mapbox Alain Juppé</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://code.jquery.com/jquery-2.1.4.min.js'></script>
    <script src='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css' rel='stylesheet' />
    <style>
      body { margin:0; padding:0; }
      #map { position:absolute; top:0; bottom:0; width:100%; }
      .legend span {
        display:block;
        float: left;
        padding-top: 2px;
        height:20px;
        width:20%;
        font-size:9px;
        color:#808080;
        margin-right: 10px;
      }
      .legend label {
        display: block;
        text-align: left;
        padding-bottom:5px;
      }
      .search-ui {
        position:absolute;
        top:20px;
        right:20px;
        font-size: 20px;
        width: 375px;
        z-index:1000;
      }
      #comites_monde_list {
        position:absolute;
        top:60px;
        right:20px;
        font-size: 20px;
        width: 375px;
        z-index:1000;
        color:#808080;
      }
    </style>
  </head>
  <body>
    <div id='legend' style='display:none;'>
      <strong>Carte des comités AJ pour la France</strong>
      <nav class='legend clearfix'>
        <span style='background:#1087bf;'></span><label>Comité Avec Juppé</label>
        <span style='background:#f86767;'></span><label>Comité Jeunes avec Juppé</label>
      </nav>
    </div>

    <div id='map'></div>
    <div>
      <input id='search' class='search-ui' placeholder='Rechercher une ville ou un code postal...' />
      <select id="comites_monde_list">
        <option value="0.600390625,47.66538735632654">...ou un comité Monde</option>
        <option value="0.600390625,47.66538735632654">FRANCE</option>
        <option value="3.0587927,36.7537703">ALGERIE</option>
        <option value="46.6730211,24.718029">ARABIE SAOUDITE</option>
        <option value="-92.2871231,34.7463534">ARKANSAS</option>
        <option value="50.5857259,26.2259212">BARHEIN</option>
        <option value="4.4045082,50.8350348">BELGIQUE</option>
        <option value="-46.6410004,-23.5586287">BRESIL</option>
        <option value="114.9342379,4.9021345">BRUNEI</option>
        <option value="-122.446929,37.768471">CALIFORNIE</option>
        <option value="104.9182484,11.5558129">CAMBODGE</option>
        <option value="11.5102118,3.8553699">CAMEROUN</option>
        <option value="-79.392281,43.6881352">CANADA</option>
        <option value="-7.589843399999999,33.5731104">CASABLANCA</option>
        <option value="-74.0723471,4.7101568">COLOMBIE</option>
        <option value="126.9882174,37.56078189999999">COREE</option>
        <option value="-4.0067756,5.3683865">COTE D'IVOIRE</option>
        <option value="31.2357116,30.0444196">EGYPTE</option>
        <option value="54.5376322,24.349032">EMIRATS ARABES UNIS</option>
        <option value="-3.7031681,40.4163911">ESPAGNE</option>
        <option value="24.7532638,59.43480880000001">ESTONIE</option>
        <option value="24.9341386,60.16813899999999">FINLANDE</option>
        <option value="44.827096,41.7151377">GEORGIE</option>
        <option value="-13.5784012,9.641185499999999">GUINEE</option>
        <option value="8.7809365,3.7513276">GUINEE EQUATORIALE</option>
        <option value="114.014138,22.3002539">HONG KONG</option>
        <option value="57.48929569999999,-20.2626168">ILE MAURICE</option>
        <option value="106.79719,-6.2922975">INDONESIE</option>
        <option value="115.1618242,-8.658612699999999">INDONESIE</option>
        <option value="12.4966889,41.9023427">ITALIE</option>
        <option value="139.6928463,35.6550583">JAPON</option>
        <option value="35.9371356,31.9633692">JORDANIE</option>
        <option value="102.6271171,17.9738054">LAOS</option>
        <option value="24.1056334,56.9506442">LETTONIE</option>
        <option value="-10.7711332,6.2906181">LIBERIA</option>
        <option value="25.2780999,54.694838">LITUANIE</option>
        <option value="-91.149058,30.448649">LOUISIANE</option>
        <option value="113.5501108,22.1995268">MACAO</option>
        <option value="101.6875739,3.1363758">MALAISIE</option>
        <option value="-7.991707399999999,12.5853394">MALI</option>
        <option value="-7.589843399999999,33.5731104">MAROC</option>
        <option value="-7.981084500000001,31.6294723">MARRAKECH</option>
        <option value="-99.1771395,19.3823834">MEXIQUE</option>
        <option value="-73.5696719,45.500393">MONTREAL</option>
        <option value="96.0836121,19.7585124">MYANMAR</option>
        <option value="-73.9829762,40.7572352">NEW YORK</option>
        <option value="-74.01168229999999,40.7096999">NEW YORK</option>
        <option value="120.9885616,14.5806537">PHILIPPINES</option>
        <option value="51.519289,25.270551">QATAR</option>
        <option value="-6.8426256,33.9673941">RABAT</option>
        <option value="26.094942,44.47669399999999">ROUMANIE</option>
        <option value="37.648098,55.7638809">RUSSIE</option>
        <option value="6.715117299999999,0.205027">SAO TOME & PRINCIPE</option>
        <option value="121.4130275,31.2028278">SHANGHAI</option>
        <option value="121.471075,31.232703">SHANGHAI</option>
        <option value="121.4663727,31.2201102">SHANGHAI</option>
        <option value="-13.2388059,8.4719651">SIERRA LEONE</option>
        <option value="103.8494022,1.3625706">SINGAPOUR</option>
        <option value="121.5649969,25.0358958">TAIWAN</option>
        <option value="-97.7437923,30.2693736">TEXAS</option>
        <option value="100.5095246,13.7556115">THAILANDE</option>
        <option value="1.2313618,6.1724969">TOGO</option>
        <option value="10.1775492,36.8009408">TUNISIE</option>
        <option value="105.8412038,21.0357334">VIETNAM</option>
        <option value="44.2069109,15.3655106">YEMEN</option>
      </select>
    </div>
    <script>
    var map;
    $(document).ready(function() {
        L.mapbox.accessToken = 'pk.eyJ1IjoibWFwYm94YWp4IiwiYSI6ImNpZ3V3dDB2czAwMzl2Zmtyb2JubXJyZGcifQ.lvgfI_Yjd5PRRoi2HB3GQQ';
        // Create a map in the div #map
        map = L.mapbox.map('map', 'mapboxajx.a6594fec', {maxZoom: 14}).setView([47.66538735632654, 0.600390625], 5).on('ready', function() { map.maxZoom = 14; });
        var featureLayerAJ = L.mapbox.featureLayer()
                            .loadURL('comites_aj.json')
                            .addTo(map);
        var featureLayerJAJ = L.mapbox.featureLayer()
                            .loadURL('comites_jaj.json')
                            .addTo(map);
        var featureLayerAJMonde = L.mapbox.featureLayer()
                            .loadURL('comites_ajmonde.json')
                            .addTo(map);
        map.legendControl.addLegend(document.getElementById('legend').innerHTML);
        $('#search').keyup(search);

        function search() {
            var searchString = $('#search').val().toLowerCase();

            featureLayerJAJ.setFilter(showState);
            featureLayerAJ.setFilter(showState);
            featureLayerAJMonde.setFilter(showState);

            function showState(feature) {
                return feature.properties.description
                    .toLowerCase()
                    .indexOf(searchString) !== -1;
            }
        }
        $('#comites_monde_list').on('change', function() {
          lng = $(this).val().split(',')[0];
          lat = $(this).val().split(',')[1];
          map.setView([lat,lng], 5);
        });
      });
      </script>
  </body>
</html>
