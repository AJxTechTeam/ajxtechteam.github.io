<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8 />
    <title>Démo Mapbox Alain Juppé</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://code.jquery.com/jquery-2.1.4.min.js'></script>
    <script src='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css' rel='stylesheet' />
    <style>
      body { margin:0; padding:0; }
      #map { position:absolute; top:0; bottom:0; width:100%; }
      .legend span {
        display:block;
        float: left;
        padding-top: 2px;
        height:20px;
        width:20%;
        font-size:9px;
        color:#808080;
        margin-right: 10px;
      }
      .legend label {
        display: block;
        text-align: left;
        padding-bottom:5px;
      }
      .search-ui {
        position:absolute;
        top:20px;
        right:20px;
        font-size: 20px;
        width: 375px;
        z-index:1000;
      }
      #comites_monde_list {
        position:absolute;
        top:60px;
        right:20px;
        font-size: 20px;
        width: 375px;
        z-index:1000;
        color:#808080;
      }
    </style>
  </head>
  <body>
    <div id='legend' style='display:none;'>
      <strong>Carte des comités AJ pour la France</strong>
      <nav class='legend clearfix'>
        <span style='background:#1087bf;'></span><label>Comité Avec Juppé</label>
        <span style='background:#f86767;'></span><label>Comité Jeunes avec Juppé</label>
      </nav>
    </div>

    <div id='map'></div>
    <div>
      <input id='search' class='search-ui' placeholder='Rechercher une ville ou un code postal...' />
      <select id="comites_monde_list">
        <option value="0.600390625,47.66538735632654">...ou un comité Monde</option>
        <option value="0.600390625,47.66538735632654">FRANCE</option>
        <option value="-4.0067756,5.3683865">ABIDJAN</option>
        <option value="54.5376322,24.349032">ABOU DABI</option>
        <option value="3.0587927,36.7537703">ALGER</option>
        <option value="35.9371356,31.9633692">AMMAN</option>
        <option value="-97.7437923,30.2693736">AUSTIN</option>
        <option value="115.1618242,-8.658612699999999">BALI</option>
        <option value="-7.991707399999999,12.5853394">BAMAKO</option>
        <option value="114.9342379,4.9021345">BANDAR SERI BEGAWAN</option>
        <option value="100.5095772,13.7560134">BANGKOK</option>
        <option value="-91.149058,30.448649">BATON ROUGE</option>
        <option value="7.4506758,46.93916360000001">BERNE</option>
        <option value="-74.0723471,4.7101568">BOGOTA</option>
        <option value="4.4045082,50.8350348">BRUXELLES</option>
        <option value="26.094942,44.47669399999999">BUCAREST</option>
        <option value="-7.589843399999999,33.5731104">CASABLANCA</option>
        <option value="-13.5784012,9.641185499999999">CONAKRY</option>
        <option value="51.519289,25.270551">DOHA</option>
        <option value="-13.2388059,8.4719651">FREETOWN</option>
        <option value="105.8412038,21.0357334">HANOI</option>
        <option value="24.9341386,60.16813899999999">HELSINKI</option>
        <option value="114.014138,22.3002539">HONG KONG</option>
        <option value="106.79719,-6.2922975">JAKARTA</option>
        <option value="101.6875739,3.1363758">KUALA LUMPUR</option>
        <option value="31.2357116,30.0444196">LE CAIRE</option>
        <option value="-92.2871231,34.7463534">LITTLE ROCK</option>
        <option value="1.2313618,6.1724969">LOME</option>
        <option value="-0.081454,51.4982903">LONDRES</option>
        <option value="113.5501108,22.1995268">MACAO</option>
        <option value="-3.7031681,40.4163911">MADRID</option>
        <option value="8.7809365,3.7513276">MALABO</option>
        <option value="50.5857259,26.2259212">MANAMA</option>
        <option value="120.9885616,14.5806537">MANILLE</option>
        <option value="-7.981084500000001,31.6294723">MARRAKECH</option>
        <option value="-99.1771395,19.3823834">MEXICO</option>
        <option value="-10.7711332,6.2906181">MONROVIA</option>
        <option value="-73.5696719,45.500393">MONTREAL</option>
        <option value="37.648098,55.7638809">MOSCOU</option>
        <option value="96.0836121,19.7585124">NAYPYIDAW</option>
        <option value="-73.9829762,40.7572352">NEW YORK</option>
        <option value="-75.6893037,45.4107768">OTTAWA</option>
        <option value="104.9307695,11.5561572">PHNOM PENH</option>
        <option value="57.48929569999999,-20.2626168">QUATRE BORNES</option>
        <option value="-6.8426256,33.9673941">RABAT</option>
        <option value="24.1056334,56.9506442">RIGA</option>
        <option value="46.6730211,24.718029">RIYAD</option>
        <option value="12.4966889,41.9023427">ROME</option>
        <option value="-122.446929,37.768471">SAN FRANCISCO</option>
        <option value="44.2069109,15.3655106">SANAA</option>
        <option value="-46.6410004,-23.5586287">SAO PAULO</option>
        <option value="6.715117299999999,0.205027">SAO TOME</option>
        <option value="126.9882174,37.56078189999999">SEOUL</option>
        <option value="121.4130275,31.2028278">SHANGHAI</option>
        <option value="121.471075,31.232703">SHANGHAI</option>
        <option value="121.4663727,31.2201102">SHANGHAI</option>
        <option value="103.8494022,1.3625706">SINGAPOUR</option>
        <option value="121.5649969,25.0358958">TAIPEI</option>
        <option value="24.7532638,59.43480880000001">TALLIN</option>
        <option value="44.827096,41.7151377">TBILISSI</option>
        <option value="139.6928463,35.6550583">TOKYO</option>
        <option value="-79.392281,43.6881352">TORONTO</option>
        <option value="10.1775492,36.8009408">TUNIS</option>
        <option value="102.6271171,17.9738054">VIENTIANE</option>
        <option value="25.2780999,54.694838">VILNIUS</option>
        <option value="11.5102118,3.8553699">YAOUNDE</option>
      </select>
    </div>
    <script>
    var map;
    $(document).ready(function() {
        L.mapbox.accessToken = 'pk.eyJ1IjoibWFwYm94YWp4IiwiYSI6ImNpZ3V3dDB2czAwMzl2Zmtyb2JubXJyZGcifQ.lvgfI_Yjd5PRRoi2HB3GQQ';
        // Create a map in the div #map
        map = L.mapbox.map('map', 'mapboxajx.a6594fec', {maxZoom: 14}).setView([47.66538735632654, 0.600390625], 5).on('ready', function() { map.maxZoom = 14; });
        var featureLayerAJ = L.mapbox.featureLayer()
                            .loadURL('comites_aj.json')
                            .addTo(map);
        var featureLayerJAJ = L.mapbox.featureLayer()
                            .loadURL('comites_jaj.json')
                            .addTo(map);
        var featureLayerAJMonde = L.mapbox.featureLayer()
                            .loadURL('comites_ajmonde.json')
                            .addTo(map);
        map.legendControl.addLegend(document.getElementById('legend').innerHTML);
        $('#search').keyup(search);

        function search() {
            var searchString = $('#search').val().toLowerCase();

            featureLayerJAJ.setFilter(showState);
            featureLayerAJ.setFilter(showState);
            featureLayerAJMonde.setFilter(showState);

            function showState(feature) {
                return feature.properties.description
                    .toLowerCase()
                    .indexOf(searchString) !== -1;
            }
        }
        $('#comites_monde_list').on('change', function() {
          lng = $(this).val().split(',')[0];
          lat = $(this).val().split(',')[1];
          map.setView([lat,lng], 5);
        });
      });
      </script>
  </body>
</html>
